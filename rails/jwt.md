## JWTとは？
JWT（ジェイウーティー、またはジョットとも呼ばれます）は、"JSON Web Token" の略です。これは、情報を安全にやり取りするための簡潔で自己完結型の方法です。具体的には、Webサイトやアプリケーションでユーザーの認証やデータの交換を行う時によく使われます。

では、JWTはどういうものなのでしょうか。JWTは、3つの部分から成り立っています：

1. **ヘッダー（Header）**: この部分には、JWTのタイプと、どのような方法で情報がエンコードされているか（たとえば、RSAやHMAC）という情報が含まれています。

2. **ペイロード（Payload）**: これがJWTのメインの部分で、実際にやり取りしたいデータがここに入ります。これには、ユーザーの名前やメールアドレスなど、JWTに関連する情報（クレームと呼ばれます）が含まれています。

3. **署名（Signature）**: これは、ヘッダーとペイロードを一緒にして、それに秘密鍵を使って作られるものです。署名によって、JWTが途中で改ざんされていないかを確認できます。

これら3つの部分は、ピリオド（.）でつながれて一つの文字列になります。

例：`ヘッダー.ペイロード.署名`

これがJWTです！🎫

なぜJWTが便利かと言うと、このトークンが自己完結型なので、すべての情報がトークン自体に詰まっています。これを使えば、サーバーとクライアント間で簡単かつ安全に情報を交換することができます。

例えば、ウェブサイトにログインする時、サーバーはJWTを作ってクライアント（ブラウザ）に送ります。ブラウザはそのJWTを保存して、次にサーバーにリクエストを送る時にJWTを一緒に送ります。これで、サーバーは誰がリクエストを送ってきたかを確認でき、必要なデータやサービスを提供します。

JWTは特に、モバイルアプリやシングルページアプリケーション（SPA）のような場所でよく使われています。

## JWTの流れ
JWTを用いた認証の流れは以下のように行われます。

1. **ユーザーがログイン**: ユーザーは、ウェブサイトやアプリケーションにログイン情報（通常はユーザー名とパスワード）を提供します。

2. **サーバーが情報を検証**: サーバーは提供されたログイン情報をデータベースや他のストレージと照合して、正しいかどうかを確認します。

3. **JWTの生成**: サーバーは、ユーザー情報が正しいと判断された場合、JWTを生成します。JWTには、ユーザーの識別情報（例：ユーザーID）や他の必要なデータが含まれていることがよくあります。これはサーバー上で署名され、改ざんできないようになります。

4. **JWTの送信**: 生成されたJWTは、ユーザー（クライアント）に送り返されます。これは通常、HTTPレスポンスの一部として送信されます。

5. **クライアントの保存**: クライアント側では、受け取ったJWTを保存します。よく使われる保存場所は、localStorageやセッションストレージ、またはクッキーです。

6. **認証が必要なリクエスト**: ユーザーが認証が必要なページにアクセスしたり、何らかの認証が必要なアクションを実行する場合、クライアントは保存しておいたJWTをサーバーに一緒に送ります。通常、これはHTTPリクエストのAuthorizationヘッダーに「Bearer トークン」の形式で含められます。

7. **サーバーでのJWT検証**: サーバーは受け取ったJWTを検証します。これは、JWTが正しい署名で署名されているか、期限切れでないかなどを確認します。

8. **リクエストの処理**: JWTの検証が成功した場合、サーバーはリクエストを処理し、必要なデータやサービスをユーザーに提供します。もしJWTが無効であった場合、サーバーはエラーレスポンスを返します。

これが、JWTを用いた認証の基本的な流れです。これにより、サーバーとクライアント間で安全にユーザーの認証情報をやりとりすることができます。

## JWT 認証のメリット・デメリット
JWTを用いた認証は、多くの場面で有用ですが、メリットとデメリットが存在します。

### メリット

1. **ステートレス性**: JWTは自己完結型であり、必要なすべての情報をトークン自体に含んでいるため、サーバー側でセッション情報を保持する必要がありません。これにより、スケーラビリティが向上します。

2. **クロスドメイン**: クッキーベースのセッションとは異なり、JWTは異なるドメイン間で簡単に使用することができます。これは、APIが異なるドメインでホストされている場合や、シングルページアプリケーションの場合に特に便利です。

3. **モバイル対応**: JWTはモバイルアプリケーションでの認証にも適しています。クッキーはモバイルアプリでの取り扱いが複雑であるため、JWTはこの状況で良い選択肢となります。

4. **組み込みの有効期限**: JWTには有効期限が組み込まれており、自動的に期限切れになることができます。これにより、セキュリティが向上します。

### デメリット

1. **サイズ**: JWTは、しばしばセッションIDよりも大きくなるため、トラフィックに影響を及ぼすことがあります。特に大量のユーザーデータを含める場合、JWTのサイズは急速に増加します。

2. **トークンの失効**: トークンには組み込まれた有効期限がありますが、一度発行されると、その期間中は無効にすることが難しいです。これは、トークンが盗まれた場合など、セキュリティ上のリスクとなり得ます。

3. **複雑さ**: シンプルなセッションベースの認証に比べ、JWTの実装はやや複雑です。開発者は署名、有効期限、ペイロードの検証など、さまざまな側面を理解する必要があります。

4. **計算コスト**: JWTの検証は、署名の検証を含むため、計算コストがかかる場合があります。大量のリクエストを処理するシステムでは、パフォーマンスに

影響を及ぼす可能性があります。

これらのメリットとデメリットを考慮し、プロジェクトの要件に応じてJWTを用いた認証が適切か判断する必要があります。
